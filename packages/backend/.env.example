# Infrastructure Mode: "cloud-dev" (managed services) or "local" (Docker services)
INFRA_MODE=cloud-dev

# Database Configuration
# Cloud-dev: Use Supabase connection string from Project Settings → Database → Connection String
#   Format: postgresql+asyncpg://postgres:[password]@[host]:5432/postgres
# Local: Use Docker PostgreSQL
#   Format: postgresql+asyncpg://postgres:postgres@localhost:5432/delight
DATABASE_URL=postgresql+asyncpg://postgres:[password]@[host]:5432/postgres

# Redis Configuration
# Cloud-dev: Use Upstash Redis URL from dashboard, OR use Docker Redis
#   Upstash format: redis://default:[password]@[host]:6379
#   Docker format: redis://localhost:6379
# Local: Use Docker Redis
#   Format: redis://localhost:6379
REDIS_URL=redis://localhost:6379

# Clerk Authentication (backend only - NEVER expose in frontend!)
# Get from https://dashboard.clerk.com → Your App → API Keys
# SECURITY: These keys grant full administrative access - keep them secret!
# The frontend uses NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY (public key), not these secret keys

# Secret Key: For session token verification
CLERK_SECRET_KEY=sk_test_...

# Webhook Secret: For validating webhook signatures from Clerk
# Get from: Clerk Dashboard → Webhooks → Your Endpoint → Signing Secret
CLERK_WEBHOOK_SECRET=whsec_...

# AI/LLM Configuration (for future epics)
# OpenAI API key from https://platform.openai.com/api-keys
# Used for GPT-4o-mini (companion chat) and GPT-4o (narrative generation)
OPENAI_API_KEY=sk-...

# Observability (optional)
# Sentry DSN from https://sentry.io → Project Settings → Client Keys (DSN)
# Free tier: 5,000 errors/month
SENTRY_DSN=https://...

# Environment
# Options: development, staging, production
ENVIRONMENT=development

# CORS Origins (comma-separated, NO TRAILING SLASHES!)
# Frontend URLs allowed to make requests to this API
# Development: Use localhost for local dev server
# Production: Add your Vercel frontend URL (e.g., https://your-app.vercel.app)
#
# IMPORTANT FOR DEPLOYMENT:
# - Railway: Set this to include your production Vercel URL
# - Format: https://your-app.vercel.app,http://localhost:3000
# - Do NOT include trailing slashes (https://domain.com/ is WRONG)
# - Do NOT use wildcards (https://*.vercel.app is NOT supported by FastAPI CORS)
#
# Example for production:
# CORS_ORIGINS=https://delight.vercel.app,https://www.delight.ai,http://localhost:3000
CORS_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

# Security Notes:
# ===============
# - NEVER commit the actual .env file (only .env.example)
# - CLERK_SECRET_KEY must ONLY be in backend environment, never frontend
# - Frontend uses NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY (safe to expose in browser)
# - The publishable key is designed for client-side use; secret key grants admin access
# - Keep OPENAI_API_KEY secure - it's tied to your billing account
#
# Infrastructure Mode Guide:
# =========================
# Cloud-Dev Mode (Recommended):
#   - INFRA_MODE=cloud-dev
#   - DATABASE_URL=<supabase-url>
#   - REDIS_URL=<upstash-url> or redis://localhost:6379 (hybrid with Docker Redis)
#   - Pros: Fast setup, production parity, no Docker required
#   - Free tiers: Supabase (500MB), Upstash (10K commands/day), Clerk (10K MAU)
#
# Local Mode (Full Offline):
#   - INFRA_MODE=local
#   - DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/delight
#   - REDIS_URL=redis://localhost:6379
#   - Requires: Docker Desktop running with `make local`
#   - Pros: Complete offline capability, no service limits, full control

